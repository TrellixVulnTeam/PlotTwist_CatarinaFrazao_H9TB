{% extends 'base-template.html' %}

{% block title %} Buscar Fornecedor {% endblock %}

{% if loggedin %} 

{% block breadcrumb %}	

    {% if breadcrumb %}
    <div class="col-sm-9 col-sm-offset-3 col-lg-10 col-lg-offset-2 main">
    <div class="row">
        <ol class="breadcrumb">
            <li><a href="#">
                <em class="fa fa-home"></em>
            </a></li>
            <li class="active">{{breadcrumb}}</li>
        </ol>
    </div>
    <!--/.row-->
    {% endif %} <!--/endif breadcrumb-->
    {% endblock %}

{% block page_header %}

    {% if page_header %}
    <div class="row">
        <div class="col-lg-12">
            <h3 class="page-header">{{page_header}}</h3>
        </div>
    </div><!--/.row-->
    {% endif %} <!--/endif page_header-->
{% endblock %}

{% block content %}
        <div class="row">
            <h1 class="display-4">Busca de Fornecedores</h1>
        </div>
        <div class="row">
            <div class="col"> 
                <table id='ListaFornecedores' class='display'>
                    <thead>
                        <tr>
                            <th>Alterar ID</th>
                            <th>NomeFornecedor</th>
                            <th>CNPJ</th>
                            <th>Contato</th>
                            <th>Ações</th>
                            <!-- <th>Deletar</th> -->
                        </tr>
                    </thead>
                    <tbody>
                        {% for fornecedor in fornecedores %}
                            <tr>
                                <td>{{ fornecedor[0] }}</td>
                                <td>{{ fornecedor[1] }}</td>
                                <td>{{ fornecedor[2] }}</td>
                                <td>{{ fornecedor[3] }}</td>
                                <td> 
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#ModalAlteraFornecedor{{ fornecedor[0] }}">
                                            Alterar
                                        </button>

                                        <button type="button" class="btn btn-danger deletar" id="Delete" value="{{ fornecedor[0] }}">
                                                Deletar
                                        </button>
                                    </div> 
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% for fornecedor in fornecedores %}
        <div class="modal fade" id="ModalAlteraFornecedor{{ fornecedor[0] }}">
                <div class="modal-dialog modal-sm">
                    <div class="modal-content">                        
                        <div class="modal-header">
                            <h4 class="modal-title">Alteração de Fornecedor</h4>
                            <button type="button" class="close" data-dismiss="modal">
                                &times;
                            </button>
                        </div>                
                        <div class="modal-body mx-3">
                            <form role="form" method="POST" action="{{ url_for('alterar_fornecedor') }}">            
                            <div class="invisible md-form mb-5">
                                <label for="idFornecedor" data-error="wrong" data-success="right">Id</label>
                                <input value="{{ fornecedor[0] }}" class="form-control validate" name="idFornecedor" id="idFornecedor" required >
                            </div>
                            <div class="md-form mb-5">
                                <label>Nome Fornecedor</label>
                                <input value="{{ fornecedor[1] }}" type="text" class="form-control" name="Nome_Fornecedor" id="Nome_Fornecedor"  required>
                            </div>
                            <div class="md-form mb-5">
                                <label>CNPJ</label>
                                <input value="{{ fornecedor[2] }}" type="text" class="form-control" name="CNPJ" id="CNPJ"  required>
                            </div>
                            <div class="md-form mb-5">
                                <label>Contato</label>
                                <input value="{{ fornecedor[3] }}" type="text" class="form-control" name="Contato" id="Contato"  required>
                            </div>
                            <button type="submit"  class="btn btn-success">Salvar</button>
                        </form>
                        </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                          </div>
                    </div>
                </div>
            </div>
            
            {% endfor %}
        <script>
            $(document).ready(function(){
                $('#ListaFornecedores').DataTable();
                $('.deletar').click(function(){
                    var idFornecedor = $(this).val()
                    Swal.fire({
                        icon: 'warning',
                        tittle: 'Exclusão de Forncecedor',
                        text: 'Você tem certeza que deseja excluir?',
                        showCancelButton: true,
                        confirmButtonText: 'Excluir!',
                        cancelButtonText: 'Cancelar'
                    }).then((result) => {
                        if (result.value){
                            var deletar = "{{ url_for('deletar_fornecedor', id = idFornecedor) }}"
                            Swal.fire(
                                'Deletedao!',
                                'O fornecedor foi cancelado.',
                                'Sucesso!'
                            )
                        }
                    })
                });
            })
        </script>

{% endblock %}

{% endif %}



